{"version":3,"sources":["Inimigo.js"],"names":["cc","Class","extends","Component","properties","alvo","Node","dano","Float","distanciaPerseguir","distanciaAtaque","tempoVagar","direcaoVagar","Vec2","vidaMaxima","_vidaAtual","_movimentacao","_controleAnimacao","_gameOver","_tempoRestanteParaVagar","_atacando","Boolean","_vivo","onLoad","getComponent","audioMorte","AudioSource","find","node","on","sofrerDano","UP","update","deltaTime","direcaoAlvo","position","sub","distancia","mag","iniciarAtaque","andar","vagar","direcao","mudaAnimacao","setDirecao","andarPraFrente","atacar","emit","Math","random","evento","detail","vidaAtual","morrer","mul","destruir","eventoMorte","Event","EventCustom","dispatchEvent","destroy"],"mappings":"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","file":"Inimigo.js","sourceRoot":"..\\..\\..\\..\\assets\\Scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        alvo: cc.Node,\n        dano : cc.Float,\n        distanciaPerseguir : cc.Float,\n        distanciaAtaque : cc.Float,\n        tempoVagar : cc.Float,\n        direcaoVagar : cc.Vec2,\n        vidaMaxima : cc.Float,\n\n        _vidaAtual : cc.Float,\n        _movimentacao : cc.Component,\n        _controleAnimacao : cc.Component,\n        _gameOver : cc.Node,\n        _tempoRestanteParaVagar : cc.Float,\n        _atacando : cc.Boolean,\n        _vivo: cc.Boolean,\n\n\n    },\n\n    onLoad: function () {\n        this._movimentacao = this.getComponent(\"Movimentacao\");\n        this._controleAnimacao = this.getComponent(\"ControleDeAnimacao\");\n        this.audioMorte = this.getComponent(cc.AudioSource);\n\n        this.alvo = cc.find(\"Personagens/Personagem\");\n        this.node.on(\"SofrerDano\", this.sofrerDano, this);\n        \n        this._tempoRestanteParaVagar = this.tempoVagar;\n        this.direcaoVagar = cc.Vec2.UP;\n\n        this._vidaAtual = this.vidaMaxima;\n        this._atacando = false;\n        this._vivo = true;\n    },\n\n    update: function (deltaTime) {\n        if(this._vivo && !this._atacando){\n            \n            this._tempoRestanteParaVagar -= deltaTime;\n            let direcaoAlvo = this.alvo.position.sub(this.node.position);\n            let distancia = direcaoAlvo.mag();\n\n            if(distancia < this.distanciaAtaque){\n                this.iniciarAtaque(direcaoAlvo);\n\n            }else if(distancia < this.distanciaPerseguir){\n                this.andar(direcaoAlvo);\n            }else{\n                this.vagar();\n            }\n        }\n\n    },\n    andar : function(direcao){\n        this._controleAnimacao.mudaAnimacao(direcao, \"Andar\");\n        this._movimentacao.setDirecao(direcao);\n        this._movimentacao.andarPraFrente();\n    },\n    iniciarAtaque: function(direcao){\n        this._controleAnimacao.mudaAnimacao(direcao, \"Atacar\");\n        this._atacando = true;\n    },\n    atacar : function(direcao){\n        this.alvo.emit(\"SofreDano\", {dano : this.dano});\n        \n        this._atacando = false;\n    },\n\n    vagar : function(){\n        if(this._tempoRestanteParaVagar < 0){\n            this.direcaoVagar = new cc.Vec2(Math.random()- 0.5,\n                                            Math.random() - 0.5);\n            this._tempoRestanteParaVagar = this.tempoVagar;\n        }\n        this.andar(this.direcaoVagar)\n    },\n    sofrerDano : function(evento){\n        this._vidaAtual -= evento.detail.dano;\n        this.node.emit(\"atualizaVida\", {vidaAtual : this._vidaAtual,\n                                        vidaMaxima : this.vidaMaxima});\n        if(this._vidaAtual < 0){\n            this.morrer();\n        }\n    },\n    \n    morrer : function(){\n        this._controleAnimacao.mudaAnimacao(cc.Vec2.UP.mul(-1), \"Morte\");\n        this._vivo = false;\n       \n\n    },\n    \n    destruir :function(){\n        this.node.emit(\"SoltarItem\");\n         let eventoMorte = new cc.Event.EventCustom(\"ZumbiMorreu\", true);\n        this.node.dispatchEvent(eventoMorte);\n         this.node.destroy();\n    }\n\n\n\n\n\n\n});\n"]}